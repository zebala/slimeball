(function(e){var f={width:730,height:375,groundHeight:75,slimeRadius:37,ballDiameter:22,ballRadius:11,goalHeight:75,goalWidth:40},c={slime:300,jump:325,ballMaxSpeed:750,gravity:1250},a={left:-1,right:1},d=function(d){d=e.extend({},{size:f,speed:c},d);this.size=d.size;this.speed=d.speed;this.direction=a;this.stage=SoccerSlime.Stage(this);this.ball=SoccerSlime.Ball(this);this.teams=[];this.slimes=[];this.teams.push(SoccerSlime.Team(this,"Red","#FF0000","left").addPlayer({up:"w",left:"a",right:"d"}));
this.teams.push(SoccerSlime.Team(this,"Green","#009900","right").addPlayer({up:"up",left:"left",right:"right"}));this.jumbotron=SoccerSlime.Jumbotron(this);this.keys=SoccerSlime.Keys(this);this.mode=SoccerSlime.Mode(this);this.updater=SoccerSlime.Updater(this);this.init()};d.prototype.gameInit=function(){this.teams[0].gameInit();this.teams[1].gameInit();this.ball.init();this.jumbotron.init()};d.prototype.init=function(){this.teams[0].init();this.teams[1].init();this.ball.init()};window&&(window.SoccerSlime=
{},window.SoccerSlime.Game=function(a){return new d(a)})})(jQuery);
(function(e){function f(a){return function(){var d=this.getContext(),c=a.game.size;d.beginPath();d.arc(0,0,c.slimeRadius,0,Math.PI,!0);d.closePath();var b=d.createRadialGradient(0,-c.slimeRadius,0,0,-c.slimeRadius,c.slimeRadius);b.addColorStop(0,"#FFFFFF");b.addColorStop(1,a.color);d.fillStyle=b;d.fill();b=c.slimeRadius/5;d.beginPath();d.arc((c.slimeRadius-b)/Math.sqrt(2)*a.direction,-(c.slimeRadius-b)/Math.sqrt(2),b,0,2*Math.PI,!0);d.fillStyle="white";d.fill();var g=a.ball.obj.getY()-a.obj.getY()+
(c.slimeRadius-b)/Math.sqrt(2),k=a.ball.obj.getX()-a.obj.getX()-(c.slimeRadius-b)/Math.sqrt(2)*a.direction,g=Math.atan2(g,k);d.beginPath();d.arc((c.slimeRadius-b)/Math.sqrt(2)*a.direction+b/2*Math.cos(g),-(c.slimeRadius-b)/Math.sqrt(2)+b/2*Math.sin(g),b/2,0,2*Math.PI,!0);d.fillStyle="black";d.fill()}}var c=function(a,d,c){this.game=a;this.color=d;this.ball=a.ball;this.direction=1;this.keys=c;this.obj=new Kinetic.Shape({drawFunc:f(this)});a.stage.gameLayer.add(this.obj);this.init()};c.prototype.init=
function(){this.vy=this.vx=0;return this};c.prototype.update=function(a){var d=this.game.keys,c=this.game.size,b=this.game.speed,g=this.game.direction;this.vx=0;d.isDown(this.keys.left)&&(this.vx=-b.slime,this.direction=g.left);d.isDown(this.keys.right)&&(this.vx=b.slime,this.direction=g.right);d.isHit(this.keys.up)&&this.obj.getY()===c.height-c.groundHeight&&(this.vy=-b.jump);this.obj.setPosition(Math.min(Math.max(this.obj.getX()+this.vx*a/1E3,c.slimeRadius),c.width-c.slimeRadius),this.obj.getY()+
this.vy*a/1E3);this.obj.getY()<c.height-c.groundHeight?this.vy+=b.gravity*a/1E3:(this.vy=0,this.obj.setPosition(this.obj.getX(),c.height-c.groundHeight));return this};SoccerSlime.Slime=function(a,d,f){return new c(a,d,f)}})(jQuery);
(function(e){var f=function(c){var a=c.size;this.obj=new Kinetic.Circle({radius:a.ballRadius,fillRadialGradientStartPoint:[a.ballRadius/2,-a.ballRadius/2],fillRadialGradientEndPoint:[0,0],fillRadialGradientStartRadius:a.ballRadius/10,fillRadialGradientEndRadius:a.ballRadius,fillRadialGradientColorStops:[0,"yellow",1,"#FFCC00"]});this.game=c;this.game.stage.gameLayer.add(this.obj);this.init()};f.prototype.init=function(){var c=this.game.size;this.vy=this.vx=0;this.obj.setPosition(c.width/2,c.height-
c.groundHeight-0.4*c.height);return this};f.prototype.update=function(c){var a=this.obj.getX(),d=this.obj.getY(),f=d,b=this.game.size,g=this.game.speed,k=Math.atan2(this.vy,this.vx),h=Math.min(Math.sqrt(Math.pow(this.vx,2)+Math.pow(this.vy,2)),g.ballMaxSpeed)*Math.pow(0.8,c/1E3);this.vx=h*Math.cos(k);this.vy=h*Math.sin(k);a+=this.vx*c/1E3;d+=this.vy*c/1E3;d+b.ballRadius<b.height-b.groundHeight?this.vy+=g.gravity*c/1E3:(d=b.height-b.groundHeight-b.ballRadius,this.vy=-this.vy/2);a<b.ballRadius&&(a=
b.ballRadius+(b.ballRadius-a)/2,this.vx=-this.vx/2);a>b.width-b.ballRadius&&(a=b.width-b.ballRadius-(b.width-b.ballRadius-a)/2,this.vx=-this.vx/2);g=this.game.slimes;for(h=0;h<g.length;h++)if(k=Math.atan2(this.vy,this.vx),Math.sqrt(Math.pow(g[h].obj.getX()-a,2)+Math.pow(g[h].obj.getY()-d,2))<b.slimeRadius+b.ballRadius&&d<g[h].obj.getY()){var e=Math.atan2(d-g[h].obj.getY(),a-g[h].obj.getX()),n=(a-g[h].obj.getX())*Math.cos(-k)+(d-g[h].obj.getY())*Math.sin(-k),l=-Math.pow(b.slimeRadius+b.ballRadius,
2)+Math.pow(a,2)-a*g[h].obj.getX()+Math.pow(g[h].obj.getX(),2)+Math.pow(d,2)-d*g[h].obj.getY()+Math.pow(g[h].obj.getY(),2),l=Math.pow(n,2)-4*l;0<=l?(e=(-n+Math.sqrt(l))/2,a+=e*cos(-k),d+=e*sin(-k)):(a=g[h].obj.getX()+(b.slimeRadius+b.ballRadius)*Math.cos(e),d=g[h].obj.getY()+(b.slimeRadius+b.ballRadius)*Math.sin(e));var e=Math.atan2(d-g[h].obj.getY(),a-g[h].obj.getX()),l=Math.cos(e)*(this.vx-g[h].vx)+Math.sin(e)*(this.vy-g[h].vy),n=Math.sin(e)*(this.vx-g[h].vx)-Math.cos(e)*(this.vy-g[h].vy),k=Math.cos(e)*
l,l=Math.sin(e)*l,p=Math.cos(e)*n,e=Math.sin(e)*n;this.vx=-k-p;this.vy=-l-e}d+b.ballRadius>b.height-b.groundHeight-b.goalHeight&&(f+b.ballRadius<=b.height-b.groundHeight-b.goalHeight&&(a<b.goalWidth||a>b.width-b.goalWidth))&&(d=b.height-b.groundHeight-b.goalHeight-b.ballRadius,this.vy=-this.vy/2,this.vx+=5*(a<b.width/2?1:-1)*c/1E3);d-b.ballRadius<b.height-b.groundHeight-b.goalHeight&&(f-b.ballRadius>=b.height-b.groundHeight-b.goalHeight&&(a<b.goalWidth||a>b.width-b.goalWidth))&&(d=b.height-b.groundHeight-
b.goalHeight+b.ballRadius,this.vy=-this.vy/2);Math.sqrt(Math.pow(b.goalWidth-a,2)+Math.pow(b.height-b.groundHeight-b.goalHeight-d,2))<=b.ballRadius&&(Math.atan2(this.vy,this.vx),this.vx=Math.abs(this.vx),this.vy*=-1);Math.sqrt(Math.pow(b.width-b.goalWidth-a,2)+Math.pow(b.height-b.groundHeight-b.goalHeight-d,2))<=b.ballRadius&&(Math.atan2(this.vy,this.vx),this.vx=-Math.abs(this.vx),this.vy*=-1);this.obj.setPosition(a,d);return this};SoccerSlime.Ball=function(c){return new f(c)}})(jQuery);
(function(e){var f=function(c,a,d,e){this.game=c;this.name=a;this.color=d;this.direction="right"===e.toLowerCase()?-1:1;this.slimes=[];this.goals=0};f.prototype.addPlayer=function(c){c=SoccerSlime.Slime(this.game,this.color,c);this.slimes.push(c);this.game.slimes.push(c);return this};f.prototype.gameInit=function(){this.init();this.goals=0;return this};f.prototype.init=function(){for(var c=this.game.size,a=(1===this.direction?0:c.width)+this.direction*(c.goalWidth+2*c.slimeRadius),d=0;d<this.slimes.length;d++){var e=
this.slimes[d];e.obj.setPosition(a+(c.width/2-a-c.slimeRadius)/Math.max(1,this.slimes.length-1)*d,c.height-c.groundHeight);e.direction=this.direction;e.init()}return this};f.prototype.score=function(){this.goals+=1};SoccerSlime.Team=function(c,a,d,e){return new f(c,a,d,e)}})(jQuery);
(function(e){function f(b){b=b.size;var a=new Kinetic.Layer;a.add(new Kinetic.Rect({x:0,y:0,width:b.width,height:b.height,fillLinearGradientStartPoint:[0,0],fillLinearGradientEndPoint:[0,b.height],fillLinearGradientColorStops:[0,"white",(b.height-b.groundHeight)/b.height,"blue",(b.height-b.groundHeight+1)/b.height,"#00C800",1,"green"]}));return a}function c(b){var a=b.size;b=new Kinetic.Layer;b.add(new Kinetic.Shape({drawFunc:function(){var b=this.getContext();b.beginPath();for(var c=0;c<=a.goalWidth;c+=
5)b.moveTo(c+0.5,a.height-a.groundHeight-a.goalHeight-0.5),b.lineTo(c+0.5,a.height-a.groundHeight);for(c=a.height-a.groundHeight-a.goalHeight;c<=a.height-a.groundHeight;c+=5)b.moveTo(0.5,c-0.5),b.lineTo(a.goalWidth+0.5,c-0.5);for(c=a.width-a.goalWidth;c<=a.width;c+=5)b.moveTo(c-0.5,a.height-a.groundHeight-a.goalHeight-0.5),b.lineTo(c-0.5,a.height-a.groundHeight);for(c=a.height-a.groundHeight-a.goalHeight;c<=a.height-a.groundHeight;c+=5)b.moveTo(a.width-a.goalWidth-0.5,c-0.5),b.lineTo(a.width,c-0.5);
b.strokeStyle="white";b.lineWidth=1;b.stroke();b.beginPath();b.rect(a.goalWidth-4.5,a.height-a.groundHeight-a.groundHeight-0.5,5,a.goalHeight);b.rect(a.width-a.goalWidth-0.5,a.height-a.groundHeight-a.groundHeight-0.5,5,a.goalHeight);b.rect(0,a.height-a.groundHeight+5,a.goalWidth+a.slimeRadius,5);b.rect(a.width-a.goalWidth-a.slimeRadius,a.height-a.groundHeight+5,a.goalWidth+a.slimeRadius,5);b.fillStyle="white";b.fill();b.stroke()}}));return b}function a(b){b=b.size;var a=new Kinetic.Layer;a.add(new Kinetic.Text({x:0,
y:b.height/2-40,fontSize:85,fontFamily:"Impact",width:b.width,text:"HTML5 Soccer Slime",fill:"white",align:"center",shadowColor:"black",shadowBlur:0.1,shadowOffset:7,shadowOpacity:0.9}));return a}function d(a){a=a.size;var c=new Kinetic.Layer;c.add(new Kinetic.Text({x:0,y:a.height-a.groundHeight-40,fontSize:20,fontFamily:"Arial",width:a.width,text:"Hit space to continue",fill:"white",align:"center"}));return c}var m=function(a){this.game=a;this.init()};m.prototype.init=function(){var b=this.game.size;
this.obj=new Kinetic.Stage({container:"slimecontainer",x:0,y:0,width:b.width,height:b.height});this.gameLayer=new Kinetic.Layer;this.menuLayer=a(this.game);this.continueLayer=d(this.game);b=new Kinetic.Layer;this.bouncingText=new Kinetic.Text({x:0,y:-1E3,fontSize:150,fontFamily:"Impact",width:this.game.size.width,text:"Goal!",fill:"white",align:"center",shadowColor:"black",shadowBlur:0.1,shadowOffset:7,shadowOpacity:0.9});b.add(this.bouncingText);this.obj.add(f(this.game));this.obj.add(this.gameLayer);
this.obj.add(c(this.game));this.obj.add(this.menuLayer);this.obj.add(this.continueLayer);this.obj.add(b);e("#slimecontainer").attr("tabindex","0");e("#slimecontainer").mousedown(function(){e(this).focus();return!1});e("#slimecontainer").css("outline","none");return this};m.prototype.startTextAnimation=function(a){var c=this.game.size,d=this.bouncingText;d.setText(a);d.setPosition(0,-d.getTextHeight());(new Kinetic.Tween({node:d,y:c.height-c.groundHeight-d.getTextHeight(),duration:1.2,easing:Kinetic.Easings.BounceEaseOut,
onFinish:function(){(new Kinetic.Tween({node:d,x:c.width,duration:1.2,easing:Kinetic.Easings.EaseIn})).play()}})).play()};SoccerSlime.Stage=function(a){return new m(a)}})(jQuery);
(function(e){function f(a){return function(c){a.time+=c.timeDiff;a.time>=45E3*a.half&&(a.time=45E3*a.half,a.stopClock());a.updateClock()}}var c=function(a){var c=a.size;this.game=a;this.obj=new Kinetic.Layer;this.obj.add(new Kinetic.Rect({x:0,y:0,width:c.width,height:75,fill:"black",opacity:0.7}));this.teamName=[];for(var e=0;2>e;e++)this.teamName[e]=new Kinetic.Text({y:20,fontSize:25,fontFamily:"Arial",fill:"white"}),this.teamName[e].setX(20),this.updateTeam(e),this.obj.add(this.teamName[e]);this.halfText=
new Kinetic.Text({x:0,y:5,width:c.width,align:"center",fontSize:25,fontFamily:"Arial",fill:"white"});this.obj.add(this.halfText);this.clock=new Kinetic.Text({x:0,y:35,width:c.width,align:"center",fontSize:25,fontFamily:"Arial",fill:"white"});this.init();this.obj.add(this.clock);a.stage.obj.add(this.obj);this.animation=new Kinetic.Animation(f(this),this.obj)};e=c.prototype;e.updateTeam=function(a){this.teamName[a].setText(this.game.teams[a].name+": "+this.game.teams[a].goals);1===a&&this.teamName[a].setX(this.game.size.width-
20-this.teamName[a].getWidth())};e.init=function(){this.setHalf(1);this.resetClock()};e.setHalf=function(a){"number"===typeof a&&(this.half=a,this.halfText.setText(a+(1===a?"st":"nd")+" Half"))};e.resetClock=function(){this.time=0;this.updateClock()};e.updateClock=function(){this.clock.setText(Math.floor(this.time/1E3)+":"+(100>this.time%1E3?"0":"")+Math.floor(this.time%1E3/10))};e.startClock=function(){this.animation.start()};e.stopClock=function(){this.animation.stop()};SoccerSlime.Jumbotron=function(a){return new c(a)}})(jQuery);
(function(e){var f=function(c){this.game=c;this.keyStatus={};this.keyHitStatus={};this.keyMap={left:37,right:39,up:38,space:32,w:87,a:65,d:68};var a=this;e("#slimecontainer").on("keydown",function(c){return a.keyDown(c.which)});e("#slimecontainer").on("keyup",function(c){return a.keyUp(c.which)})};f.prototype.checkKey=function(c){for(var a in this.keyMap)if(this.keyMap[a]===c)return!0;return!1};f.prototype.keyDown=function(c){this.checkKey(c)&&(this.keyHitStatus[c]=this.keyStatus[c]?!1:!0,this.keyStatus[c]=
!0);return!1};f.prototype.keyUp=function(c){this.checkKey(c)&&(this.keyHitStatus[c]=!1,this.keyStatus[c]=!1);return!1};f.prototype.isDown=function(c){return this.keyStatus[this.keyMap[c]]};f.prototype.isHit=function(c){return this.keyHitStatus[this.keyMap[c]]};SoccerSlime.Keys=function(c){return new f(c)}})(jQuery);
(function(e){var f=function(a){this.game=a;this.animation=new Kinetic.Animation(c(a),a.stage.gameLayer);this.animation.start()},c=function(b){return function(c){c=c.timeDiff;switch(b.mode()){case "menu":b.keys.isHit("space")&&b.mode("game");break;case "game":a(b,c);b.ball.update(c);d(b);m(b);break;case "goal":a(b,c);b.ball.update(c);break;case "continueGame":b.keys.isHit("space")&&b.mode("game");break;case "halfTime":a(b,c);b.ball.update(c);break;case "gameOver":a(b,c);b.ball.update(c);b.keys.isHit("space")&&
setTimeout(function(){b.mode("menu")},100);break;case "test":a(b,c),b.ball.update(c)}}},a=function(a,c){for(var d=0;d<a.slimes.length;d++)a.slimes[d].update(c)},d=function(a){var c=a.ball,d=a.size,e;c.obj.getX()<d.goalWidth&&c.obj.getY()>d.height-d.groundHeight-d.goalHeight&&(e=1);c.obj.getX()>d.width-d.goalWidth&&c.obj.getY()>d.height-d.groundHeight-d.goalHeight&&(e=0);"undefined"!==typeof e&&(a.teams[e].score(),a.jumbotron.updateTeam(e),a.stage.obj.draw(),a.mode("goal"),setTimeout(function(){a.mode("continueGame")},
1500))},m=function(a){jumbo=a.jumbotron;jumbo.time===45E3*jumbo.half&&(jumbo.setHalf(2),a.mode("halfTime"),setTimeout(function(){45E3===jumbo.time?a.mode("continueGame"):a.mode("gameOver")},1500))};SoccerSlime.Updater=function(a){return new f(a)}})(jQuery);
(function(e){var f={menu:0,game:1,goal:2,continueGame:3,halfTime:4,gameOver:5,test:6};SoccerSlime.Mode=function(a){var d=f.menu;return function(e){if("undefined"===typeof e)for(var b in f)if(f[b]===d)return b;if("string"===typeof e)for(b in f)if(b===e){d=f[b];if(c.hasOwnProperty(b))c[b](a);return d}if("number"===typeof e)return d=e}};var c={menu:function(a){a.gameInit();a.stage.menuLayer.setVisible(!0);a.stage.continueLayer.setVisible(!0);a.jumbotron.resetClock();a.jumbotron.stopClock();a.stage.obj.draw()},
goal:function(a){a.jumbotron.stopClock();a.stage.startTextAnimation("Goal!")},continueGame:function(a){a.init();a.jumbotron.stopClock();a.stage.menuLayer.setVisible(!1);a.stage.continueLayer.setVisible(!0)},game:function(a){a.jumbotron.startClock();a.stage.menuLayer.setVisible(!1);a.stage.continueLayer.setVisible(!1)},halfTime:function(a){a.jumbotron.stopClock();45E3===a.jumbotron.time?a.stage.startTextAnimation("Half-time"):a.teams[0].goals>a.teams[1].goals?a.stage.startTextAnimation(a.teams[0].name+
" wins!"):a.teams[0].goals<a.teams[1].goals?a.stage.startTextAnimation(a.teams[1].name+" wins!"):a.stage.startTextAnimation("Tie")},gameOver:function(a){a.jumbotron.stopClock();a.stage.menuLayer.setVisible(!1);a.stage.continueLayer.setVisible(!0)}}})(jQuery);(function(e){SoccerSlime.Game()})(jQuery);
